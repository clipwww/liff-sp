import{m as r,b as n,T as l,n as v}from"./index-7cae2806.js";import{m as i}from"./firebase-df27de50.js";const d={data(){return{favoriteList:[],isLoading:!1}},computed:{...r({isLoggedIn:"isLoggedIn",profile:"profile"})},beforeRouteEnter(a,t,e){n.state.isLoggedIn?e():(l.fail("必須要登入才可以使用唷！"),e({name:"MovieSearchTypeChoice"}))},created(){this.isLoading=!0,i.child(`favorite-movie-${this.profile.userId}`).on("value",a=>{const t=a.val();t&&(t!=null&&t.length)&&(this.favoriteList=t||[]),this.isLoading=!1})},beforeUnmount(){i.child(`favorite-movie-${this.profile.userId}`).off()},methods:{async removeFavorite(a){try{await this.$dialog.confirm({title:"確定要刪除收藏嗎？"}),this.favoriteList=this.favoriteList.filter(t=>t.id!==a.id),i.child(`favorite-movie-${this.profile.userId}`).set(this.favoriteList)}catch(t){}},getSrc(a=""){return!a||a.includes("l10l010l3322l1")?"https://via.placeholder.com/250x370?text=404":a},goMovie({id:a}){this.$router.push({name:"MovieDetails",params:{id:a}})}}};var c=function(){var t=this,e=t._self._c;return e("div",{staticClass:"favorite-list"},[e("van-panel",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}]},[e("div",{staticClass:"padding-bt-10",attrs:{slot:"header"},slot:"header"},[e("van-skeleton",{attrs:{title:"",avatar:"","avatar-shape":"",row:4}})],1)]),t._l(t.favoriteList,function(s){return e("van-panel",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],key:s.id,staticClass:"margin-bt-10"},[e("div",{attrs:{slot:"header"},slot:"header"},[e("van-cell",{attrs:{title:s.name,size:"large"}},[e("van-image",{attrs:{slot:"right-icon",width:"40",fit:"contain",src:s.cerImg,"lazy-load":""},slot:"right-icon"})],1)],1),e("van-row",{staticClass:"padding-lr-15",attrs:{gutter:15}},[e("van-col",{attrs:{span:"7"}},[e("van-image",{attrs:{src:t.getSrc(s.poster),width:"100%","lazy-load":""},on:{click:function(o){return t.goMovie(s)}}})],1),e("van-col",{attrs:{span:"17"}},[e("p",{staticClass:"fs-14"},[t._v(" "+t._s(s.description)+" ")]),e("van-tag",{staticClass:"margin-r-5 margin-bt-5",attrs:{plain:""}},[t._v(" 片長: "+t._s(s.runtime)+" 分 ")]),e("van-tag",{staticClass:"margin-bt-5",attrs:{plain:""}},[t._v(" 上映日期: "+t._s(s.releaseDate)+" ")])],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("div",{staticClass:"flex-between"},[e("div",{staticClass:"little-text"},[t._v(" 加入收藏日期 "+t._s(t._f("formatDate")(s.dateCreated))+" ")]),e("van-button",{attrs:{icon:"delete",type:"danger",size:"small"},on:{click:function(o){return t.removeFavorite(s)}}},[t._v(" 刪除收藏 ")])],1)])],1)}),e("van-panel",{directives:[{name:"show",rawName:"v-show",value:!t.favoriteList.length&&!t.isLoading,expression:"!favoriteList.length && !isLoading"}]},[e("div",{attrs:{slot:"header"},slot:"header"},[e("div",{staticClass:"text-center padding-bt-30"},[e("van-icon",{staticClass:"fs-30",attrs:{name:"info"}}),e("div",[t._v("這裡還什麼都沒有")])],1)])])],2)},f=[],g=v(d,c,f,!1,null,"31982cfb",null,null);const m=g.exports;export{m as default};
