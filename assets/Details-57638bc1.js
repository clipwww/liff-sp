import{n as o,I as n}from"./index-7cae2806.js";import{g as r}from"./komica.svc-1aea49a4.js";import"./firebase-df27de50.js";import"./acnh.svc-9e14a934.js";import{K as l}from"./KomicaPostCell-c1e2f583.js";import"./index-8db10a04.js";const c={components:{KomicaPostCell:l},metaInfo(){var s;return{title:this.$route.query.title||((s=this.post)==null?void 0:s.title)}},data(){return{post:null,isRefreshing:!1,showPopup:!1}},computed:{komicaType(){switch(!0){case this.$route.name.includes("KomicaNew"):return"new";case this.$route.name.includes("KomicaLive"):return"live";default:return""}},postId(){return this.$route.params.id},imageObjs(){var e;const s=[],t=((e=this.post)==null?void 0:e.reply.filter(a=>a.sImg&&a.oImg))??[];return this.post&&this.post.sImg&&this.post.oImg&&s.push(this.post),s.concat(t)},sImages(){return this.imageObjs.map(s=>s.sImg)},oImages(){return this.imageObjs.map(s=>s.oImg)}},created(){this.getDetails()},methods:{async getDetails(){this.post=null,this.isRefreshing=!1;const s=await r(this.komicaType,this.postId);s.success&&(this.post=s.item)},onClickImage(s){const t=this.oImages.findIndex(e=>e===s.oImg)||0;n({images:this.oImages,startPosition:t,closeable:!0,showIndex:!0,loop:!0,closeOnPopstate:!0,lazyLoad:!0})},onTabClick(s){switch(s){case"up":window.scrollTo(0,0);break;case"down":window.scrollTo(0,document.body.clientHeight);break;case"iamges":this.showPopup=!0;break}},openOriginPage(){window.liff.openWindow({url:this.post.url})}}};var p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"with-safe-area-inset-bottom"},[e("van-pull-refresh",{attrs:{"head-height":"150"},on:{refresh:t.getDetails},model:{value:t.isRefreshing,callback:function(a){t.isRefreshing=a},expression:"isRefreshing"}},[e("van-cell-group",[e("van-skeleton",{staticClass:"padding-bt-15",attrs:{title:"",avatar:"","avatar-shape":"square","avatar-size":"90",row:4,loading:!t.post}},[t.post?[e("KomicaPostCell",{attrs:{item:t.post,"is-details":!0},on:{"click-image":t.onClickImage}}),t._l(t.post.reply,function(a){return e("KomicaPostCell",{key:a.id,attrs:{item:a,"o-item":t.post,"is-details":!0},on:{"click-image":t.onClickImage}})})]:t._e()],2),t._l(4,function(a){return e("van-skeleton",{key:a,staticClass:"padding-bt-15",attrs:{row:4,title:"",loading:!t.post}})})],2)],1),e("van-popup",{style:{height:"80%"},attrs:{round:"",position:"bottom","close-on-popstate":""},model:{value:t.showPopup,callback:function(a){t.showPopup=a},expression:"showPopup"}},[e("van-grid",{staticClass:"padding-bt-15",attrs:{"column-num":4}},t._l(t.imageObjs,function(a,i){return e("van-grid-item",{key:i},[e("van-image",{attrs:{src:a.sImg,fit:"cover","lazy-load":""},on:{click:function(g){return t.onClickImage(a)}}})],1)}),1)],1),e("van-tabbar",{attrs:{fixed:"",route:"","safe-area-inset-bottom":""},on:{change:t.onTabClick}},[e("van-tabbar-item",{attrs:{icon:"arrow-up",name:"up"}},[t._v(" 至頂 ")]),e("van-tabbar-item",{attrs:{icon:"photo",name:"iamges"}},[t._v(" 瀏覽圖片 ")]),e("van-tabbar-item",{attrs:{icon:"arrow-down",name:"down"}},[t._v(" 至底 ")])],1),e("van-button",{staticClass:"fixed-btn padding-lr-5",attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.openOriginPage}},[t._v(" 開啟原頁面 ")])],1)},m=[],u=o(c,p,m,!1,null,"b2547265",null,null);const w=u.exports;export{w as default};
