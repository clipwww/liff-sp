import{c as ge,g as ye,n as be,h as we}from"./index-71d8585f.js";import{a as $e,b as ze}from"./himawari.svc-79044a74.js";import"./firebase-b7fcb020.js";import"./acnh.svc-a593798b.js";var Se=function(){if(typeof document>"u")return"transform";for(var e=["oTransform","msTransform","mozTransform","webkitTransform","transform"],t=document.createElement("div").style,i=0;i<e.length;i++)if(e[i]in t)return e[i];return"transform"}();function xe(e){var t=document.createElement("div");if(t.style.cssText="position:absolute;",typeof e.render=="function"){var i=e.render();if(i instanceof HTMLElement)return t.appendChild(i),t}if(t.textContent=e.text,e.style)for(var s in e.style)t.style[s]=e.style[s];return t}function Te(){var e=document.createElement("div");return e.style.cssText="overflow:hidden;white-space:nowrap;transform:translateZ(0);",e}function ke(e){for(var t=e.lastChild;t;)e.removeChild(t),t=e.lastChild}function De(e,t,i){e.style.width=t+"px",e.style.height=i+"px"}function Ce(){}function Ie(e,t){var i=document.createDocumentFragment(),s=0,n=null;for(s=0;s<t.length;s++)n=t[s],n.node=n.node||xe(n),i.appendChild(n.node);for(t.length&&e.appendChild(i),s=0;s<t.length;s++)n=t[s],n.width=n.width||n.node.offsetWidth,n.height=n.height||n.node.offsetHeight}function Oe(e,t){t.node.style[Se]="translate("+t.x+"px,"+t.y+"px)"}function Re(e,t){e.removeChild(t.node),this.media||(t.node=null)}var Ee={name:"dom",init:Te,clear:ke,resize:De,framing:Ce,setup:Ie,render:Oe,remove:Re},k=typeof window<"u"&&window.devicePixelRatio||1,U=Object.create(null);function Ve(e,t){if(U[e])return U[e];var i=12,s=/(\d+(?:\.\d+)?)(px|%|em|rem)(?:\s*\/\s*(\d+(?:\.\d+)?)(px|%|em|rem)?)?/,n=e.match(s);if(n){var r=n[1]*1||10,l=n[2],o=n[3]*1||1.2,a=n[4];l==="%"&&(r*=t.container/100),l==="em"&&(r*=t.container),l==="rem"&&(r*=t.root),a==="px"&&(i=o),a==="%"&&(i=r*o/100),a==="em"&&(i=r*o),a==="rem"&&(i=t.root*o),a===void 0&&(i=r*o)}return U[e]=i,i}function Ae(e,t){if(typeof e.render=="function"){var i=e.render();if(i instanceof HTMLCanvasElement)return e.width=i.width,e.height=i.height,i}var s=document.createElement("canvas"),n=s.getContext("2d"),r=e.style||{};r.font=r.font||"10px sans-serif",r.textBaseline=r.textBaseline||"bottom";var l=r.lineWidth*1;l=l>0&&l!==1/0?Math.ceil(l):!!r.strokeStyle*1,n.font=r.font,e.width=e.width||Math.max(1,Math.ceil(n.measureText(e.text).width)+l*2),e.height=e.height||Math.ceil(Ve(r.font,t))+l*2,s.width=e.width*k,s.height=e.height*k,n.scale(k,k);for(var o in r)n[o]=r[o];var a=0;switch(r.textBaseline){case"top":case"hanging":a=l;break;case"middle":a=e.height>>1;break;default:a=e.height-l}return r.strokeStyle&&n.strokeText(e.text,l,a),n.fillText(e.text,l,a),s}function ee(e){return window.getComputedStyle(e,null).getPropertyValue("font-size").match(/(.+)px/)[1]*1}function Le(e){var t=document.createElement("canvas");return t.context=t.getContext("2d"),t._fontSize={root:ee(document.getElementsByTagName("html")[0]),container:ee(e)},t}function Pe(e,t){e.context.clearRect(0,0,e.width,e.height);for(var i=0;i<t.length;i++)t[i].canvas=null}function Me(e,t,i){e.width=t*k,e.height=i*k,e.style.width=t+"px",e.style.height=i+"px"}function Fe(e){e.context.clearRect(0,0,e.width,e.height)}function Ue(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.canvas=Ae(s,e._fontSize)}}function He(e,t){e.context.drawImage(t.canvas,t.x*k,t.y*k)}function Ne(e,t){t.canvas=null}var je={name:"canvas",init:Le,clear:Pe,resize:Me,framing:Fe,setup:Ue,render:He,remove:Ne};function We(e){var t=this,i=this.media?this.media.currentTime:Date.now()/1e3,s=this.media?this.media.playbackRate:1;function n(g,v){if(v.mode==="top"||v.mode==="bottom")return i-g.time<t._.duration;var m=t._.width+g.width,C=m*(i-g.time)*s/t._.duration;if(g.width>C)return!0;var y=t._.duration+g.time-i,b=t._.width+v.width,c=t.media?v.time:v._utc,S=b*(i-c)*s/t._.duration,R=t._.width-S,z=t._.duration*R/(t._.width+v.width);return y>z}for(var r=this._.space[e.mode],l=0,o=0,a=1;a<r.length;a++){var d=r[a],u=e.height;if((e.mode==="top"||e.mode==="bottom")&&(u+=d.height),d.range-d.height-r[l].range>=u){o=a;break}n(d,e)&&(l=a)}var p=r[l].range,f={range:p+e.height,time:this.media?e.time:e._utc,width:e.width,height:e.height};return r.splice(l+1,o-l-1,f),e.mode==="bottom"?this._.height-e.height-p%this._.height:p%(this._.height-e.height)}function Be(e,t,i,s){return function(){e(this._.stage);var n=Date.now()/1e3,r=this.media?this.media.currentTime:n,l=this.media?this.media.playbackRate:1,o=null,a=0,d=0;for(d=this._.runningList.length-1;d>=0;d--)o=this._.runningList[d],a=this.media?o.time:o._utc,r-a>this._.duration&&(s(this._.stage,o),this._.runningList.splice(d,1));for(var u=[];this._.position<this.comments.length&&(o=this.comments[this._.position],a=this.media?o.time:o._utc,!(a>=r));){if(r-a>this._.duration){++this._.position;continue}this.media&&(o._utc=n-(this.media.currentTime-o.time)),u.push(o),++this._.position}for(t(this._.stage,u),d=0;d<u.length;d++)o=u[d],o.y=We.call(this,o),this._.runningList.push(o);for(d=0;d<this._.runningList.length;d++){o=this._.runningList[d];var p=this._.width+o.width,f=p*(n-o._utc)*l/this._.duration;o.mode==="ltr"&&(o.x=f-o.width+.5|0),o.mode==="rtl"&&(o.x=this._.width-f+.5|0),(o.mode==="top"||o.mode==="bottom")&&(o.x=this._.width-o.width>>1),i(this._.stage,o)}}}var te=typeof window<"u"&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,50/3)},qe=typeof window<"u"&&(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame)||clearTimeout;function re(e,t,i){for(var s=0,n=0,r=e.length;n<r-1;)s=n+r>>1,i>=e[s][t]?n=s:r=s;return e[n]&&i<e[n][t]?n:r}function oe(e){return/^(ltr|top|bottom)$/i.test(e)?e.toLowerCase():"rtl"}function E(){var e=9007199254740991;return[{range:0,time:-e,width:e,height:0},{range:e,time:e,width:0,height:0}]}function le(e){e.ltr=E(),e.rtl=E(),e.top=E(),e.bottom=E()}function G(){if(!this._.visible||!this._.paused)return this;if(this._.paused=!1,this.media)for(var e=0;e<this._.runningList.length;e++){var t=this._.runningList[e];t._utc=Date.now()/1e3-(this.media.currentTime-t.time)}var i=this,s=Be(this._.engine.framing.bind(this),this._.engine.setup.bind(this),this._.engine.render.bind(this),this._.engine.remove.bind(this));function n(){s.call(i),i._.requestID=te(n)}return this._.requestID=te(n),this}function K(){return!this._.visible||this._.paused?this:(this._.paused=!0,qe(this._.requestID),this._.requestID=0,this)}function X(){if(!this.media)return this;this.clear(),le(this._.space);var e=re(this.comments,"time",this.media.currentTime);return this._.position=Math.max(0,e-1),this}function Ge(e){e.play=G.bind(this),e.pause=K.bind(this),e.seeking=X.bind(this),this.media.addEventListener("play",e.play),this.media.addEventListener("pause",e.pause),this.media.addEventListener("playing",e.play),this.media.addEventListener("waiting",e.pause),this.media.addEventListener("seeking",e.seeking)}function Ke(e){this.media.removeEventListener("play",e.play),this.media.removeEventListener("pause",e.pause),this.media.removeEventListener("playing",e.play),this.media.removeEventListener("waiting",e.pause),this.media.removeEventListener("seeking",e.seeking),e.play=null,e.pause=null,e.seeking=null}function Xe(e){this._={},this.container=e.container||document.createElement("div"),this.media=e.media,this._.visible=!0,this.engine=(e.engine||"DOM").toLowerCase(),this._.engine=this.engine==="canvas"?je:Ee,this._.requestID=0,this._.speed=Math.max(0,e.speed)||144,this._.duration=4,this.comments=e.comments||[],this.comments.sort(function(i,s){return i.time-s.time});for(var t=0;t<this.comments.length;t++)this.comments[t].mode=oe(this.comments[t].mode);return this._.runningList=[],this._.position=0,this._.paused=!0,this.media&&(this._.listener={},Ge.call(this,this._.listener)),this._.stage=this._.engine.init(this.container),this._.stage.style.cssText+="position:relative;pointer-events:none;",this.resize(),this.container.appendChild(this._.stage),this._.space={},le(this._.space),(!this.media||!this.media.paused)&&(X.call(this),G.call(this)),this}function Ye(){if(!this.container)return this;K.call(this),this.clear(),this.container.removeChild(this._.stage),this.media&&Ke.call(this,this._.listener);for(var e in this)Object.prototype.hasOwnProperty.call(this,e)&&(this[e]=null);return this}var V=["mode","time","text","render","style"];function Ze(e){if(!e||Object.prototype.toString.call(e)!=="[object Object]")return this;for(var t={},i=0;i<V.length;i++)e[V[i]]!==void 0&&(t[V[i]]=e[V[i]]);if(t.text=(t.text||"").toString(),t.mode=oe(t.mode),t._utc=Date.now()/1e3,this.media){var s=0;t.time===void 0?(t.time=this.media.currentTime,s=this._.position):(s=re(this.comments,"time",t.time),s<this._.position&&(this._.position+=1)),this.comments.splice(s,0,t)}else this.comments.push(t);return this}function Je(){return this._.visible?this:(this._.visible=!0,this.media&&this.media.paused?this:(X.call(this),G.call(this),this))}function Qe(){return this._.visible?(K.call(this),this.clear(),this._.visible=!1,this):this}function et(){return this._.engine.clear(this._.stage,this._.runningList),this._.runningList=[],this}function tt(){return this._.width=this.container.offsetWidth,this._.height=this.container.offsetHeight,this._.engine.resize(this._.stage,this._.width,this._.height),this._.duration=this._.width/this._.speed,this}var it={get:function(){return this._.speed},set:function(e){return typeof e!="number"||isNaN(e)||!isFinite(e)||e<=0?this._.speed:(this._.speed=e,this._.width&&(this._.duration=this._.width/e),e)}};function D(e){e&&Xe.call(this,e)}D.prototype.destroy=function(){return Ye.call(this)};D.prototype.emit=function(e){return Ze.call(this,e)};D.prototype.show=function(){return Je.call(this)};D.prototype.hide=function(){return Qe.call(this)};D.prototype.clear=function(){return et.call(this)};D.prototype.resize=function(){return tt.call(this)};Object.defineProperty(D.prototype,"speed",it);function st(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var i=e.indexOf("Trident/");if(i>0){var s=e.indexOf("rv:");return parseInt(e.substring(s+3,e.indexOf(".",s)),10)}var n=e.indexOf("Edge/");return n>0?parseInt(e.substring(n+5,e.indexOf(".",n)),10):-1}var A=void 0;function H(){H.init||(H.init=!0,A=st()!==-1)}var N={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"resize-observer",attrs:{tabindex:"-1"}})},staticRenderFns:[],_scopeId:"data-v-b329ee4c",name:"resize-observer",methods:{compareAndNotify:function(){(this._w!==this.$el.offsetWidth||this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.$emit("notify"))},addResizeHandlers:function(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers:function(){this._resizeObject&&this._resizeObject.onload&&(!A&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),delete this._resizeObject.onload)}},mounted:function(){var t=this;H(),this.$nextTick(function(){t._w=t.$el.offsetWidth,t._h=t.$el.offsetHeight});var i=document.createElement("object");this._resizeObject=i,i.setAttribute("aria-hidden","true"),i.setAttribute("tabindex",-1),i.onload=this.addResizeHandlers,i.type="text/html",A&&this.$el.appendChild(i),i.data="about:blank",A||this.$el.appendChild(i)},beforeDestroy:function(){this.removeResizeHandlers()}};function nt(e){e.component("resize-observer",N),e.component("ResizeObserver",N)}var rt={version:"0.4.5",install:nt},P=null;typeof window<"u"?P=window.Vue:typeof global<"u"&&(P=global.Vue);P&&P.use(rt);function L(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?L=function(t){return typeof t}:L=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(e)}function ot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ie(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function lt(e,t,i){return t&&ie(e.prototype,t),i&&ie(e,i),e}function se(e){return at(e)||dt(e)||ct()}function at(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}function dt(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function ct(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function ht(e){var t;return typeof e=="function"?t={callback:e}:t=e,t}function ut(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s,n,r,l=function(a){for(var d=arguments.length,u=new Array(d>1?d-1:0),p=1;p<d;p++)u[p-1]=arguments[p];if(r=u,!(s&&a===n)){var f=i.leading;typeof f=="function"&&(f=f(a,n)),(!s||a!==n)&&f&&e.apply(void 0,[a].concat(se(r))),n=a,clearTimeout(s),s=setTimeout(function(){e.apply(void 0,[a].concat(se(r))),s=0},t)}};return l._clear=function(){clearTimeout(s),s=null},l}function ae(e,t){if(e===t)return!0;if(L(e)==="object"){for(var i in e)if(!ae(e[i],t[i]))return!1;return!0}return!1}var ft=function(){function e(t,i,s){ot(this,e),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(i,s)}return lt(e,[{key:"createObserver",value:function(i,s){var n=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=ht(i),this.callback=function(o,a){n.options.callback(o,a),o&&n.options.once&&(n.frozen=!0,n.destroyObserver())},this.callback&&this.options.throttle){var r=this.options.throttleOptions||{},l=r.leading;this.callback=ut(this.callback,this.options.throttle,{leading:function(a){return l==="both"||l==="visible"&&a||l==="hidden"&&!a}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(o){var a=o[0];if(o.length>1){var d=o.find(function(p){return p.isIntersecting});d&&(a=d)}if(n.callback){var u=a.isIntersecting&&a.intersectionRatio>=n.threshold;if(u===n.oldResult)return;n.oldResult=u,n.callback(u,a)}},this.options.intersection),s.context.$nextTick(function(){n.observer&&n.observer.observe(n.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&this.options.intersection.threshold||0}}]),e}();function de(e,t,i){var s=t.value;if(s)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var n=new ft(e,s,i);e._vue_visibilityState=n}}function mt(e,t,i){var s=t.value,n=t.oldValue;if(!ae(s,n)){var r=e._vue_visibilityState;if(!s){ce(e);return}r?r.createObserver(s,i):de(e,{value:s},i)}}function ce(e){var t=e._vue_visibilityState;t&&(t.destroyObserver(),delete e._vue_visibilityState)}var he={bind:de,update:mt,unbind:ce};function pt(e){e.directive("observe-visibility",he)}var vt={version:"0.4.6",install:pt},M=null;typeof window<"u"?M=window.Vue:typeof global<"u"&&(M=global.Vue);M&&M.use(vt);var ue={exports:{}};(function(e){(function(t,i){e.exports?e.exports=i():t.Scrollparent=i()})(ge,function(){function t(s){var n=getComputedStyle(s,null).getPropertyValue("overflow");return n.indexOf("scroll")>-1||n.indexOf("auto")>-1}function i(s){if(s instanceof HTMLElement||s instanceof SVGElement){for(var n=s.parentNode;n.parentNode;){if(t(n))return n;n=n.parentNode}return document.scrollingElement||document.documentElement}}return i})})(ue);var _t=ue.exports;const ne=ye(_t);var fe={itemsLimit:1e3};const me={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function pe(){return this.items.length&&typeof this.items[0]!="object"}let j=!1;if(typeof window<"u"){j=!1;try{var gt=Object.defineProperty({},"passive",{get(){j=!0}});window.addEventListener("test",null,gt)}catch{}}let yt=0;var bt={name:"RecycleScroller",components:{ResizeObserver:N},directives:{ObserveVisibility:he},props:{...me,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const e={"-1":{accumulator:0}},t=this.items,i=this.sizeField,s=this.minItemSize;let n=1e4,r=0,l;for(let o=0,a=t.length;o<a;o++)l=t[o][i]||s,l<n&&(n=l),r+=l,e[o]={accumulator:r,size:l};return this.$_computedMinItemSize=n,e}return[]},simpleArray:pe},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const e=this.$_lastUpdateScrollPosition;typeof e=="number"&&this.$nextTick(()=>{this.scrollToPosition(e)})},beforeDestroy(){this.removeListeners()},methods:{addView(e,t,i,s,n){const r={item:i,position:0},l={id:yt++,index:t,used:!0,key:s,type:n};return Object.defineProperty(r,"nr",{configurable:!1,value:l}),e.push(r),r},unuseView(e,t=!1){const i=this.$_unusedViews,s=e.nr.type;let n=i.get(s);n||(n=[],i.set(s,n)),n.push(e),t||(e.nr.used=!1,e.position=-9999,this.$_views.delete(e.nr.key))},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(e){this.$_scrollDirty||(this.$_scrollDirty=!0,requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:t}=this.updateVisibleItems(!1,!0);t||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,100))}))},handleVisibilityChange(e,t){this.ready&&(e||t.boundingClientRect.width!==0||t.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(e,t=!1){const i=this.itemSize,s=this.gridItems||1,n=this.itemSecondarySize||i,r=this.$_computedMinItemSize,l=this.typeField,o=this.simpleArray?null:this.keyField,a=this.items,d=a.length,u=this.sizes,p=this.$_views,f=this.$_unusedViews,g=this.pool;let v,m,C,y,b;if(!d)v=m=y=b=C=0;else if(this.$_prerender)v=y=0,m=b=Math.min(this.prerender,a.length),C=null;else{const h=this.getScroll();if(t){let w=h.start-this.$_lastUpdateScrollPosition;if(w<0&&(w=-w),i===null&&w<r||w<i)return{continuous:!0}}this.$_lastUpdateScrollPosition=h.start;const _=this.buffer;h.start-=_,h.end+=_;let I=0;if(this.$refs.before&&(I=this.$refs.before.scrollHeight,h.start-=I),this.$refs.after){const w=this.$refs.after.scrollHeight;h.end+=w}if(i===null){let w,Z=0,J=d-1,$=~~(d/2),Q;do Q=$,w=u[$].accumulator,w<h.start?Z=$:$<d-1&&u[$+1].accumulator>h.start&&(J=$),$=~~((Z+J)/2);while($!==Q);for($<0&&($=0),v=$,C=u[d-1].accumulator,m=$;m<d&&u[m].accumulator<h.end;m++);for(m===-1?m=a.length-1:(m++,m>d&&(m=d)),y=v;y<d&&I+u[y].accumulator<h.start;y++);for(b=y;b<d&&I+u[b].accumulator<h.end;b++);}else{v=~~(h.start/i*s);const w=v%s;v-=w,m=Math.ceil(h.end/i*s),y=Math.max(0,Math.floor((h.start-I)/i*s)),b=Math.floor((h.end-I)/i*s),v<0&&(v=0),m>d&&(m=d),y<0&&(y=0),b>d&&(b=d),C=Math.ceil(d/s)*i}}m-v>fe.itemsLimit&&this.itemsLimitError(),this.totalSize=C;let c;const S=v<=this.$_endIndex&&m>=this.$_startIndex;if(this.$_continuous!==S){if(S){p.clear(),f.clear();for(let h=0,_=g.length;h<_;h++)c=g[h],this.unuseView(c)}this.$_continuous=S}else if(S)for(let h=0,_=g.length;h<_;h++)c=g[h],c.nr.used&&(e&&(c.nr.index=a.indexOf(c.item)),(c.nr.index===-1||c.nr.index<v||c.nr.index>=m)&&this.unuseView(c));const R=S?null:new Map;let z,x,T,O;for(let h=v;h<m;h++){z=a[h];const _=o?z[o]:z;if(_==null)throw new Error(`Key is ${_} on item (keyField is '${o}')`);if(c=p.get(_),!i&&!u[h].size){c&&this.unuseView(c);continue}c?(c.nr.used=!0,c.item=z):(h===a.length-1&&this.$emit("scroll-end"),h===0&&this.$emit("scroll-start"),x=z[l],T=f.get(x),S?T&&T.length?(c=T.pop(),c.item=z,c.nr.used=!0,c.nr.index=h,c.nr.key=_,c.nr.type=x):c=this.addView(g,h,z,_,x):(O=R.get(x)||0,(!T||O>=T.length)&&(c=this.addView(g,h,z,_,x),this.unuseView(c,!0),T=f.get(x)),c=T[O],c.item=z,c.nr.used=!0,c.nr.index=h,c.nr.key=_,c.nr.type=x,R.set(x,O+1),O++),p.set(_,c)),i===null?(c.position=u[h-1].accumulator,c.offset=0):(c.position=Math.floor(h/s)*i,c.offset=h%s*n)}return this.$_startIndex=v,this.$_endIndex=m,this.emitUpdate&&this.$emit("update",v,m,y,b),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,300),{continuous:S}},getListenerTarget(){let e=ne(this.$el);return window.document&&(e===window.document.documentElement||e===window.document.body)&&(e=window),e},getScroll(){const{$el:e,direction:t}=this,i=t==="vertical";let s;if(this.pageMode){const n=e.getBoundingClientRect(),r=i?n.height:n.width;let l=-(i?n.top:n.left),o=i?window.innerHeight:window.innerWidth;l<0&&(o+=l,l=0),l+o>r&&(o=r-l),s={start:l,end:l+o}}else i?s={start:e.scrollTop,end:e.scrollTop+e.clientHeight}:s={start:e.scrollLeft,end:e.scrollLeft+e.clientWidth};return s},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,j?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(e){let t;this.itemSize===null?t=e>0?this.sizes[e-1].accumulator:0:t=Math.floor(e/this.gridItems)*this.itemSize,this.scrollToPosition(t)},scrollToPosition(e){const t=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let i,s,n;if(this.pageMode){const r=ne(this.$el),l=r.tagName==="HTML"?0:r[t.scroll],o=r.getBoundingClientRect(),d=this.$el.getBoundingClientRect()[t.start]-o[t.start];i=r,s=t.scroll,n=e+l+d}else i=this.$el,s=t.scroll,n=e;i[s]=n},itemsLimitError(){throw setTimeout(()=>{this.$el}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((e,t)=>e.nr.index-t.nr.index)}}};function Y(e,t,i,s,n,r,l,o,a,d){typeof l!="boolean"&&(a=o,o=l,l=!1);const u=typeof i=="function"?i.options:i;e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,n&&(u.functional=!0)),s&&(u._scopeId=s);let p;if(r?(p=function(f){f=f||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!f&&typeof __VUE_SSR_CONTEXT__<"u"&&(f=__VUE_SSR_CONTEXT__),t&&t.call(this,a(f)),f&&f._registeredComponents&&f._registeredComponents.add(r)},u._ssrRegister=p):t&&(p=l?function(f){t.call(this,d(f,this.$root.$options.shadowRoot))}:function(f){t.call(this,o(f))}),p)if(u.functional){const f=u.render;u.render=function(v,m){return p.call(m),f(v,m)}}else{const f=u.beforeCreate;u.beforeCreate=f?[].concat(f,p):[p]}return i}const wt=bt;var ve=function(){var e,t,i=this,s=i.$createElement,n=i._self._c||s;return n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:i.handleVisibilityChange,expression:"handleVisibilityChange"}],staticClass:"vue-recycle-scroller",class:(e={ready:i.ready,"page-mode":i.pageMode},e["direction-"+i.direction]=!0,e),on:{"&scroll":function(r){return i.handleScroll.apply(null,arguments)}}},[i.$slots.before?n("div",{ref:"before",staticClass:"vue-recycle-scroller__slot"},[i._t("before")],2):i._e(),i._v(" "),n(i.listTag,{ref:"wrapper",tag:"component",staticClass:"vue-recycle-scroller__item-wrapper",class:i.listClass,style:(t={},t[i.direction==="vertical"?"minHeight":"minWidth"]=i.totalSize+"px",t)},[i._l(i.pool,function(r){return n(i.itemTag,i._g({key:r.nr.id,tag:"component",staticClass:"vue-recycle-scroller__item-view",class:[i.itemClass,{hover:!i.skipHover&&i.hoverKey===r.nr.key}],style:i.ready?{transform:"translate"+(i.direction==="vertical"?"Y":"X")+"("+r.position+"px) translate"+(i.direction==="vertical"?"X":"Y")+"("+r.offset+"px)",width:i.gridItems?(i.direction==="vertical"&&i.itemSecondarySize||i.itemSize)+"px":void 0,height:i.gridItems?(i.direction==="horizontal"&&i.itemSecondarySize||i.itemSize)+"px":void 0}:null},i.skipHover?{}:{mouseenter:function(){i.hoverKey=r.nr.key},mouseleave:function(){i.hoverKey=null}}),[i._t("default",null,{item:r.item,index:r.nr.index,active:r.nr.used})],2)}),i._v(" "),i._t("empty")],2),i._v(" "),i.$slots.after?n("div",{ref:"after",staticClass:"vue-recycle-scroller__slot"},[i._t("after")],2):i._e(),i._v(" "),n("ResizeObserver",{on:{notify:i.handleResize}})],1)},$t=[];ve._withStripped=!0;const zt=void 0,St=void 0,xt=void 0,Tt=!1,W=Y({render:ve,staticRenderFns:$t},zt,wt,St,Tt,xt,!1,void 0,void 0,void 0);var kt={name:"DynamicScroller",components:{RecycleScroller:W},provide(){return typeof ResizeObserver<"u"&&(this.$_resizeObserver=new ResizeObserver(e=>{requestAnimationFrame(()=>{if(Array.isArray(e)){for(const t of e)if(t.target){const i=new CustomEvent("resize",{detail:{contentRect:t.contentRect}});t.target.dispatchEvent(i)}}})})),{vscrollData:this.vscrollData,vscrollParent:this,vscrollResizeObserver:this.$_resizeObserver}},inheritAttrs:!1,props:{...me,minItemSize:{type:[Number,String],required:!0}},data(){return{vscrollData:{active:!0,sizes:{},validSizes:{},keyField:this.keyField,simpleArray:!1}}},computed:{simpleArray:pe,itemsWithSize(){const e=[],{items:t,keyField:i,simpleArray:s}=this,n=this.vscrollData.sizes,r=t.length;for(let l=0;l<r;l++){const o=t[l],a=s?l:o[i];let d=n[a];typeof d>"u"&&!this.$_undefinedMap[a]&&(d=0),e.push({item:o,id:a,size:d})}return e},listeners(){const e={};for(const t in this.$listeners)t!=="resize"&&t!=="visible"&&(e[t]=this.$listeners[t]);return e}},watch:{items(){this.forceUpdate(!1)},simpleArray:{handler(e){this.vscrollData.simpleArray=e},immediate:!0},direction(e){this.forceUpdate(!0)},itemsWithSize(e,t){const i=this.$el.scrollTop;let s=0,n=0;const r=Math.min(e.length,t.length);for(let o=0;o<r&&!(s>=i);o++)s+=t[o].size||this.minItemSize,n+=e[o].size||this.minItemSize;const l=n-s;l!==0&&(this.$el.scrollTop+=l)}},beforeCreate(){this.$_updates=[],this.$_undefinedSizes=0,this.$_undefinedMap={}},activated(){this.vscrollData.active=!0},deactivated(){this.vscrollData.active=!1},methods:{onScrollerResize(){this.$refs.scroller&&this.forceUpdate(),this.$emit("resize")},onScrollerVisible(){this.$emit("vscroll:update",{force:!1}),this.$emit("visible")},forceUpdate(e=!0){(e||this.simpleArray)&&(this.vscrollData.validSizes={}),this.$emit("vscroll:update",{force:!0})},scrollToItem(e){const t=this.$refs.scroller;t&&t.scrollToItem(e)},getItemSize(e,t=void 0){const i=this.simpleArray?t??this.items.indexOf(e):e[this.keyField];return this.vscrollData.sizes[i]||0},scrollToBottom(){if(this.$_scrollingToBottom)return;this.$_scrollingToBottom=!0;const e=this.$el;this.$nextTick(()=>{e.scrollTop=e.scrollHeight+5e3;const t=()=>{e.scrollTop=e.scrollHeight+5e3,requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight+5e3,this.$_undefinedSizes===0?this.$_scrollingToBottom=!1:requestAnimationFrame(t)})};requestAnimationFrame(t)})}}};const Dt=kt;var _e=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("RecycleScroller",e._g(e._b({ref:"scroller",attrs:{items:e.itemsWithSize,"min-item-size":e.minItemSize,direction:e.direction,"key-field":"id","list-tag":e.listTag,"item-tag":e.itemTag},on:{resize:e.onScrollerResize,visible:e.onScrollerVisible},scopedSlots:e._u([{key:"default",fn:function(s){var n=s.item,r=s.index,l=s.active;return[e._t("default",null,null,{item:n.item,index:r,active:l,itemWithSize:n})]}}],null,!0)},"RecycleScroller",e.$attrs,!1),e.listeners),[e._v(" "),i("template",{slot:"before"},[e._t("before")],2),e._v(" "),i("template",{slot:"after"},[e._t("after")],2),e._v(" "),i("template",{slot:"empty"},[e._t("empty")],2)],2)},Ct=[];_e._withStripped=!0;const It=void 0,Ot=void 0,Rt=void 0,Et=!1,B=Y({render:_e,staticRenderFns:Ct},It,Dt,Ot,Et,Rt,!1,void 0,void 0,void 0);var Vt={name:"DynamicScrollerItem",inject:["vscrollData","vscrollParent","vscrollResizeObserver"],props:{item:{required:!0},watchData:{type:Boolean,default:!1},active:{type:Boolean,required:!0},index:{type:Number,default:void 0},sizeDependencies:{type:[Array,Object],default:null},emitResize:{type:Boolean,default:!1},tag:{type:String,default:"div"}},computed:{id(){if(this.vscrollData.simpleArray)return this.index;if(this.item.hasOwnProperty(this.vscrollData.keyField))return this.item[this.vscrollData.keyField];throw new Error(`keyField '${this.vscrollData.keyField}' not found in your item. You should set a valid keyField prop on your Scroller`)},size(){return this.vscrollData.validSizes[this.id]&&this.vscrollData.sizes[this.id]||0},finalActive(){return this.active&&this.vscrollData.active}},watch:{watchData:"updateWatchData",id(){this.size||this.onDataUpdate()},finalActive(e){this.size||(e?this.vscrollParent.$_undefinedMap[this.id]||(this.vscrollParent.$_undefinedSizes++,this.vscrollParent.$_undefinedMap[this.id]=!0):this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=!1)),this.vscrollResizeObserver?e?this.observeSize():this.unobserveSize():e&&this.$_pendingVScrollUpdate===this.id&&this.updateSize()}},created(){if(!this.$isServer&&(this.$_forceNextVScrollUpdate=null,this.updateWatchData(),!this.vscrollResizeObserver)){for(const e in this.sizeDependencies)this.$watch(()=>this.sizeDependencies[e],this.onDataUpdate);this.vscrollParent.$on("vscroll:update",this.onVscrollUpdate),this.vscrollParent.$on("vscroll:update-size",this.onVscrollUpdateSize)}},mounted(){this.vscrollData.active&&(this.updateSize(),this.observeSize())},beforeDestroy(){this.vscrollParent.$off("vscroll:update",this.onVscrollUpdate),this.vscrollParent.$off("vscroll:update-size",this.onVscrollUpdateSize),this.unobserveSize()},methods:{updateSize(){this.finalActive?this.$_pendingSizeUpdate!==this.id&&(this.$_pendingSizeUpdate=this.id,this.$_forceNextVScrollUpdate=null,this.$_pendingVScrollUpdate=null,this.computeSize(this.id)):this.$_forceNextVScrollUpdate=this.id},updateWatchData(){this.watchData&&!this.vscrollResizeObserver?this.$_watchData=this.$watch("item",()=>{this.onDataUpdate()},{deep:!0}):this.$_watchData&&(this.$_watchData(),this.$_watchData=null)},onVscrollUpdate({force:e}){!this.finalActive&&e&&(this.$_pendingVScrollUpdate=this.id),(this.$_forceNextVScrollUpdate===this.id||e||!this.size)&&this.updateSize()},onDataUpdate(){this.updateSize()},computeSize(e){this.$nextTick(()=>{if(this.id===e){const t=this.$el.offsetWidth,i=this.$el.offsetHeight;this.applySize(t,i)}this.$_pendingSizeUpdate=null})},applySize(e,t){const i=~~(this.vscrollParent.direction==="vertical"?t:e);i&&this.size!==i&&(this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=void 0),this.$set(this.vscrollData.sizes,this.id,i),this.$set(this.vscrollData.validSizes,this.id,!0),this.emitResize&&this.$emit("resize",this.id))},observeSize(){!this.vscrollResizeObserver||!this.$el.parentNode||(this.vscrollResizeObserver.observe(this.$el.parentNode),this.$el.parentNode.addEventListener("resize",this.onResize))},unobserveSize(){this.vscrollResizeObserver&&(this.vscrollResizeObserver.unobserve(this.$el.parentNode),this.$el.parentNode.removeEventListener("resize",this.onResize))},onResize(e){const{width:t,height:i}=e.detail.contentRect;this.applySize(t,i)}},render(e){return e(this.tag,this.$slots.default)}};const At=Vt,Lt=void 0,Pt=void 0,Mt=void 0,Ft=void 0,q=Y({},Lt,At,Pt,Ft,Mt,!1,void 0,void 0,void 0);function Ut(e,t){e.component(`${t}recycle-scroller`,W),e.component(`${t}RecycleScroller`,W),e.component(`${t}dynamic-scroller`,B),e.component(`${t}DynamicScroller`,B),e.component(`${t}dynamic-scroller-item`,q),e.component(`${t}DynamicScrollerItem`,q)}const Ht={version:"1.1.2",install(e,t){const i=Object.assign({},{installComponents:!0,componentsPrefix:""},t);for(const s in i)typeof i[s]<"u"&&(fe[s]=i[s]);i.installComponents&&Ut(e,i.componentsPrefix)}};let F=null;typeof window<"u"?F=window.Vue:typeof global<"u"&&(F=global.Vue);F&&F.use(Ht);const Nt={components:{DynamicScroller:B,DynamicScrollerItem:q},metaInfo(){var e;return{title:this.$route.query.title||((e=this.post)==null?void 0:e.title)}},data(){return{item:null,damaku:null,comments:[],playUrl:"",showPopup:!1}},computed:{imgSrc(){var t,i;let e=(t=this.item)==null?void 0:t.img_big_url;return typeof e!="string"&&(e=(i=this.item)==null?void 0:i.img_small_url),typeof e!="string"?"":e},dougaId(){return this.$route.params.id},formatTime(){return we().startOf("day").add(this.item.movie_time,"second").format("HH:mm:ss")},videoSrc(){return this.playUrl.slice(0,this.playUrl.indexOf("&movie_url_id="))},sourceOptions(){var e,t,i,s,n;return[{text:`${(e=this.item)==null?void 0:e.movie_width}x${(t=this.item)==null?void 0:t.movie_height}`,value:(i=this.item)==null?void 0:i.movie_url}].concat(((n=(s=this.item)==null?void 0:s.add_source)==null?void 0:n.map(r=>({text:`${r.movie_width}x${r.movie_height}`,value:r.movie_url})))??[])}},created(){this.getDetails(),this.getDanmaku()},beforeUnmount(){var e;(e=this.danmaku)==null||e.destroy()},methods:{async getDetails(){var t;const e=await $e(this.dougaId);e.success&&(this.item=e.item,this.playUrl=((t=this.item)==null?void 0:t.movie_url)??"")},async getDanmaku(){const e=await ze(this.dougaId);if(!e.success)return;this.comments=e.items;const t=this.comments.map(i=>({text:i.msg,time:i.vpos_master/100,style:{font:"16px sans-serif",textAlign:"start",textBaseline:"bottom",direction:"inherit",fillStyle:"#fff",strokeStyle:"#fff",lineWidth:1}}));this.danmaku?this.danmaku.comments=t:this.$nextTick(()=>{this.danmaku=new D({engine:"canvas",container:document.getElementById("js-video-container"),media:document.getElementById("js-video"),comments:t})})},openUrl(e){window.liff.openWindow({url:e.movie_url,external:!0})},goHimawari(){window.liff.openWindow({url:`http://himado.in/${this.dougaId}`,external:!0})},onError(e){this.$toast.fail(e.message)}}};var jt=function(){var t=this,i=t._self._c;return i("div",[i("van-skeleton",{staticClass:"padding-bt-15",attrs:{title:"",avatar:"","avatar-shape":"",row:5,loading:!t.item}}),t.item?[i("van-panel",{attrs:{desc:t.item.sub_title}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("van-cell",[i("div",{staticClass:"margin-b-10",attrs:{slot:"title"},slot:"title"},[t._v(" "+t._s(t.item.title)+" "),i("van-tag",{staticClass:"margin-l-5",attrs:{slot:"right-icon",type:"primary",size:"mini",plain:""},slot:"right-icon"},[t._v(" "+t._s(t.item.number)+" ")])],1),i("div",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.item.sub_title)+" ")])])],1),i("div",{staticClass:"padding-a-10"},[i("div",{staticClass:"video-wrapper",attrs:{id:"js-video-container"}},[i("video",{attrs:{id:"js-video",src:t.videoSrc,poster:t.imgSrc,controls:"",playsinline:"","webkit-playsinline":""},on:{error:t.onError}})]),i("div",{staticClass:"little-text margin-t-10"},[t._v(" "+t._s(t.item.author_comment)+" ")]),i("div",{staticClass:"margin-t-10"},[i("van-tag",{attrs:{type:"default"}},[t._v(" 類別: "+t._s(t.item.author_tag)+" ")]),i("van-tag",{staticClass:"margin-l-10",attrs:{type:"default"}},[t._v(" 長度: "+t._s(t.formatTime)+" ")])],1)]),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"text-right"},[i("van-button",{staticClass:"padding-lr-5 margin-r-5",attrs:{type:"primary",size:"mini",plain:""},on:{click:function(s){t.showPopup=!0}}},[t._v(" 彈幕列表 ")]),i("van-button",{staticClass:"padding-lr-5",attrs:{type:"info",size:"mini",plain:""},on:{click:t.goHimawari}},[t._v(" 前往原頁面 ")])],1)])]),i("van-dropdown-menu",{attrs:{direction:"up"}},[i("van-dropdown-item",{attrs:{options:t.sourceOptions},model:{value:t.playUrl,callback:function(s){t.playUrl=s},expression:"playUrl"}})],1),i("van-cell",{attrs:{"is-link":"",center:"",clickable:""},on:{click:function(s){return t.openUrl(t.item)}}},[i("div",{attrs:{slot:"title"},slot:"title"},[t._v(" "+t._s(t.item.movie_width)+"x"+t._s(t.item.movie_height)+" ")]),i("div",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t._f("formatDate")(t.item.add_date))+" ")])]),t._l(t.item.add_source,function(s){return i("van-cell",{key:s.source_id,attrs:{"is-link":"",center:"",clickable:""},on:{click:function(n){return t.openUrl(s)}}},[i("div",{attrs:{slot:"title"},slot:"title"},[t._v(" "+t._s(s.movie_width)+"x"+t._s(s.movie_height)+" "),typeof s.memo=="string"?i("van-tag",{staticClass:"margin-l-5",attrs:{type:"success",size:"mini",plain:""}},[t._v(" "+t._s(s.memo)+" ")]):t._e()],1),i("div",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t._f("formatDate")(s.adddate))+" ")])])}),i("van-popup",{style:{height:"87%"},attrs:{round:"",position:"bottom","close-on-popstate":""},model:{value:t.showPopup,callback:function(s){t.showPopup=s},expression:"showPopup"}},[i("DynamicScroller",{staticClass:"scroller",attrs:{items:t.comments,"key-field":"no","min-item-size":33},scopedSlots:t._u([{key:"default",fn:function({item:s,index:n,active:r}){return[i("DynamicScrollerItem",{attrs:{item:s,active:r,"size-dependencies":[s.msg],"data-index":n}},[i("div",{staticClass:"scroller__item"},[i("div",{staticClass:"little-text"},[t._v(" "+t._s(s.digital_time)+" ")]),i("div",{staticClass:"scroller__item__msg"},[t._v(" "+t._s(s.msg)+" ")])])])]}}],null,!1,296350010)})],1)]:t._e()],2)},Wt=[],Bt=be(Nt,jt,Wt,!1,null,"59d3d8ad",null,null);const Yt=Bt.exports;export{Yt as default};
