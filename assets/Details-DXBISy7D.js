import{K as O}from"./KomicaPostCell-BVdn-9KH.js";import"./acnh.svc-Dirrrzgx.js";import{_ as T,r as n,o as l,c as p,a as o,w as a,F as u,d as g,e as h,f as K,b as c,I as R}from"./index-D_e8FN_z.js";import{g as V}from"./komica.svc-C6hyQkTY.js";import"./firebase-LKY1-RY1.js";import"./index-C0sn0UrP.js";const D={components:{KomicaPostCell:O},metaInfo(){return{title:this.$route.query.title||this.post?.title}},data(){return{post:null,isRefreshing:!1,showPopup:!1}},computed:{komicaType(){switch(!0){case this.$route.name.includes("KomicaNew"):return"new";case this.$route.name.includes("KomicaLive"):return"live";default:return""}},postId(){return this.$route.params.id},imageObjs(){const t=[],e=this.post?.reply.filter(m=>m.sImg&&m.oImg)??[];return this.post&&this.post.sImg&&this.post.oImg&&t.push(this.post),t.concat(e)},sImages(){return this.imageObjs.map(t=>t.sImg)},oImages(){return this.imageObjs.map(t=>t.oImg)}},created(){this.getDetails()},methods:{async getDetails(){this.post=null,this.isRefreshing=!1;const t=await V(this.komicaType,this.postId);t.success&&(this.post=t.item)},onClickImage(t){const e=this.oImages.findIndex(m=>m===t.oImg)||0;R({images:this.oImages,startPosition:e,closeable:!0,showIndex:!0,loop:!0,closeOnPopstate:!0,lazyLoad:!0})},onTabClick(t){switch(t){case"up":window.scrollTo(0,0);break;case"down":window.scrollTo(0,document.body.clientHeight);break;case"iamges":this.showPopup=!0;break}},openOriginPage(){window.liff.openWindow({url:this.post.url})}}},j={class:"with-safe-area-inset-bottom"};function z(t,e,m,N,i,r){const _=n("KomicaPostCell"),f=n("van-skeleton"),w=n("van-cell-group"),v=n("van-pull-refresh"),b=n("van-image"),I=n("van-grid-item"),k=n("van-grid"),C=n("van-popup"),d=n("van-tabbar-item"),y=n("van-tabbar"),P=n("van-button");return l(),p("div",j,[o(v,{modelValue:i.isRefreshing,"onUpdate:modelValue":e[0]||(e[0]=s=>i.isRefreshing=s),"head-height":"150",onRefresh:r.getDetails},{default:a(()=>[o(w,null,{default:a(()=>[o(f,{class:"padding-bt-15",title:"",avatar:"","avatar-shape":"square","avatar-size":"90",row:4,loading:!i.post},{default:a(()=>[i.post?(l(),p(u,{key:0},[o(_,{item:i.post,"is-details":!0,onClickImage:r.onClickImage},null,8,["item","onClickImage"]),(l(!0),p(u,null,g(i.post.reply,s=>(l(),h(_,{key:s.id,item:s,"o-item":i.post,"is-details":!0,onClickImage:r.onClickImage},null,8,["item","o-item","onClickImage"]))),128))],64)):K("",!0)]),_:1},8,["loading"]),(l(),p(u,null,g(4,s=>o(f,{key:s,class:"padding-bt-15",row:4,title:"",loading:!i.post},null,8,["loading"])),64))]),_:1})]),_:1},8,["modelValue","onRefresh"]),o(C,{show:i.showPopup,"onUpdate:show":e[1]||(e[1]=s=>i.showPopup=s),round:"",position:"bottom","close-on-popstate":"",style:{height:"80%"}},{default:a(()=>[o(k,{class:"padding-bt-15","column-num":4},{default:a(()=>[(l(!0),p(u,null,g(r.imageObjs,(s,x)=>(l(),h(I,{key:x},{default:a(()=>[o(b,{src:s.sImg,fit:"cover","lazy-load":"",onClick:B=>r.onClickImage(s)},null,8,["src","onClick"])]),_:2},1024))),128))]),_:1})]),_:1},8,["show"]),o(y,{fixed:"",route:"","safe-area-inset-bottom":"",onChange:r.onTabClick},{default:a(()=>[o(d,{icon:"arrow-up",name:"up"},{default:a(()=>[...e[2]||(e[2]=[c(" 至頂 ",-1)])]),_:1}),o(d,{icon:"photo",name:"iamges"},{default:a(()=>[...e[3]||(e[3]=[c(" 瀏覽圖片 ",-1)])]),_:1}),o(d,{icon:"arrow-down",name:"down"},{default:a(()=>[...e[4]||(e[4]=[c(" 至底 ",-1)])]),_:1})]),_:1},8,["onChange"]),o(P,{class:"fixed-btn padding-lr-5",type:"primary",plain:"",size:"mini",onClick:r.openOriginPage},{default:a(()=>[...e[5]||(e[5]=[c(" 開啟原頁面 ",-1)])]),_:1},8,["onClick"])])}const W=T(D,[["render",z],["__scopeId","data-v-da3ffc97"]]);export{W as default};
