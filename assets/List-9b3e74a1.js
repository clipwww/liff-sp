import{n as h,_ as r,h as o,l as d}from"./index-7cae2806.js";import"./firebase-df27de50.js";import{g as _}from"./acnh.svc-9e14a934.js";function l(i){switch(i){case"Anteater":return"食蟻獸";case"Bear":return"大熊";case"Bird":return"鳥";case"Bull":return"公牛";case"Cat":return"貓";case"Cub":return"小熊";case"Chicken":return"雞";case"Cow":return"乳牛";case"Alligator":return"鱷魚";case"Deer":return"鹿";case"Dog":return"狗";case"Duck":return"鴨";case"Elephant":return"象";case"Frog":return"蛙";case"Goat":return"山羊";case"Gorilla":return"猩猩";case"Hamster":return"倉鼠";case"Hippo":return"河馬";case"Horse":return"馬";case"Koala":return"無尾熊";case"Kangaroo":return"袋鼠";case"Lion":return"獅";case"Monkey":return"猴";case"Mouse":return"鼠";case"Octopus":return"章魚";case"Eagle":return"鷹";case"Penguin":return"企鵝";case"Pig":return"豬";case"Rabbit":return"兔";case"Rhino":return"犀牛";case"Sheep":return"綿羊";case"Squirrel":return"松鼠";case"Tiger":return"虎";case"Wolf":return"狼";case"Ostrich":return"鴕鳥";default:return i}}const p={filters:{translateSpecies:l},components:{AcnhFishDetails:()=>r(()=>import("./AcnhFishDetails-452ea787.js"),["assets/AcnhFishDetails-452ea787.js","assets/index-7cae2806.js","assets/index-bbd2f3a7.css","assets/Category-1a84b608.css"]),AcnhBugsDetails:()=>r(()=>import("./AcnhBugsDetails-dcc1846d.js"),["assets/AcnhBugsDetails-dcc1846d.js","assets/index-7cae2806.js","assets/index-bbd2f3a7.css","assets/Category-1a84b608.css"]),AcnhFossilsDetails:()=>r(()=>import("./AcnhFossilsDetails-2e54041d.js"),["assets/AcnhFossilsDetails-2e54041d.js","assets/index-7cae2806.js","assets/index-bbd2f3a7.css","assets/Category-1a84b608.css"]),AcnhVillagersDetails:()=>r(()=>import("./AcnhVillagersDetails-59de3eaf.js"),["assets/AcnhVillagersDetails-59de3eaf.js","assets/index-7cae2806.js","assets/index-bbd2f3a7.css","assets/firebase-df27de50.js","assets/acnh.svc-9e14a934.js","assets/Category-1a84b608.css"]),AcnhArtDetails:()=>r(()=>import("./AcnhArtDetails-b870f379.js"),["assets/AcnhArtDetails-b870f379.js","assets/index-7cae2806.js","assets/index-bbd2f3a7.css","assets/Category-1a84b608.css"]),AcnhSongsDetails:()=>r(()=>import("./AcnhSongsDetails-39b4ab44.js"),["assets/AcnhSongsDetails-39b4ab44.js","assets/index-7cae2806.js","assets/index-bbd2f3a7.css","assets/Category-1a84b608.css"])},data(){return{keyword:"",species:"",list:null,isLoading:!1,isFinished:!1,showDetails:!1,showSelect:!1,item:null,page:1}},computed:{type(){switch(this.$route.name){case"AcnhFish":return"fish";case"AcnhBugs":return"bugs";case"AcnhFossils":return"fossils";case"AcnhVillagers":return"villagers";case"AcnhSongs":return"songs";case"AcnhArt":return"art";default:return""}},isVillagers(){return this.type==="villagers"},detailsComponentName(){return`${this.$route.name}Details`},objToList(){return Object.keys(this.list||{}).map(i=>this.list[i])},filterList(){var i,e,s;return((s=(e=(i=this.objToList)==null?void 0:i.filter(t=>this.keyword?Object.keys(t.name).some(a=>{var n,c,u;return((u=(n=t.name[a])==null?void 0:n.toLowerCase())==null?void 0:u.includes((c=this.keyword)==null?void 0:c.toLowerCase()))||(t.species?l(t.species).includes(this.keyword)||t.species.includes(this.keyword):!1)}):!0))==null?void 0:e.filter(t=>this.species?t.species===this.species:!0))==null?void 0:s.slice(0,this.page*10))??[]},actions(){const i=new Set;return this.objToList.forEach(e=>{i.add(e.species)}),[{name:"全部",value:""},...Array.from(i).map(e=>({name:l(e),value:e}))]}},watch:{type:{immediate:!0,handler(){this.toTop(),this.keyword="",this.species="",this.item=null,this.list=null,this.isFinished=!1,this.isLoading=!1,this.showSelect=!1,this.showDetails=!1,this.page=1,this.getList()}},species(){this.page=1,this.toTop()},keyword(){this.page=1,this.toTop()},showDetails(i){i||(this.item=null)}},methods:{async getList(){this.isLoading=!0;const i=this.type,e=await _(this.type);this.isLoading=!1,!(!e||i!==this.type)&&(this.list=e,this.checkBirthday())},onLoad(){this.isFinished||(this.page+=1,this.filterList.length===this.objToList.length&&(this.isFinished=!0))},checkBirthday(){if(!this.isVillagers)return;const i=this.objToList.filter(s=>o().isSame(o(s.birthday,"D/M"),"day")),e=o().format("M/D");if(i.length&&!localStorage.getItem(e))try{this.$dialog({title:`今日 ${e} 壽星`,message:i.map(s=>`<div class="text-center" style="white-space: initial">
                    <div>${s.name["name-TWzh"]}</div>
                    <img src="${s.icon_uri}" width="80"/>
                  </div>`).join(", "),showCancelButton:!0,confirmButtonText:"今日不再顯示",cancelButtonText:"關閉",beforeClose(s,t){s==="confirm"&&localStorage.setItem(e,1),t()}})}catch(s){}},toTop(){this.$nextTick(()=>{this.$refs.list.scrollTop=0})},openDetails(i){var e;d("狸端機 Lite","開啟詳細資料",`[${this.type}] ${(e=i==null?void 0:i.name)==null?void 0:e["name-TWzh"]}`),this.showDetails=!0,this.item=i},onSelect(i){this.species=i.value,this.showSelect=!1}}};var f=function(){var e=this,s=e._self._c;return s("div",{staticClass:"list__container"},[s("van-search",{attrs:{"show-action":e.isVillagers,placeholder:"請輸入關鍵字搜尋"},model:{value:e.keyword,callback:function(t){e.keyword=typeof t=="string"?t.trim():t},expression:"keyword"}},[s("van-button",{attrs:{slot:"action",icon:"arrow-down",size:"small"},on:{click:function(t){e.showSelect=!0}},slot:"action"},[e._v(" "+e._s(e._f("translateSpecies")(e.species||"全部"))+" ")])],1),s("van-action-sheet",{attrs:{actions:e.actions},on:{select:e.onSelect},model:{value:e.showSelect,callback:function(t){e.showSelect=t},expression:"showSelect"}}),s("div",{ref:"list",staticClass:"list__content with-safe-area-inset-bottom"},[s("van-list",{attrs:{finished:e.isFinished,"finished-text":"没有更多了",offset:10},on:{load:e.onLoad}},[e.isLoading?s("div",e._l(10,function(t){return s("van-cell",{key:t},[s("van-skeleton",{staticClass:"padding-bt-5 padding-lr-0",attrs:{row:1,title:"",avatar:"","avatar-shape":"square","avatar-size":"65"}})],1)}),1):e._e(),e.list?e._l(e.filterList,function(t,a){return s("van-cell",{key:t.id,attrs:{title:t.name["name-TWzh"],"is-link":"",center:""},on:{click:function(n){return e.openDetails(t)}}},[t.icon_uri||t.image_uri?s("van-image",{staticClass:"margin-r-10",attrs:{slot:"icon",width:"65",src:t.icon_uri||t.image_uri.toLowerCase(),"lazy-load":a>0},slot:"icon"}):e._e(),s("div",{attrs:{slot:"label"},slot:"label"},[t.price?[s("span",{staticClass:"little-text"},[e._v("賣價")]),e._v(" "+e._s(e._f("commafy")(t.price))+" ")]:e._e(),t.species?s("div",[e._v(" "+e._s(e._f("translateSpecies")(t.species))+" ")]):e._e()],2)],1)}):e._e()],2)],1),s("van-popup",{style:{height:"90%"},attrs:{round:"",position:"bottom",closeable:""},model:{value:e.showDetails,callback:function(t){e.showDetails=t},expression:"showDetails"}},[e.item?s("div",{staticClass:"safe-area-inset-bottom"},[s(e.detailsComponentName,{tag:"component",attrs:{item:e.item}})],1):e._e()])],1)},g=[],m=h(p,f,g,!1,null,"bb722506",null,null);const v=m.exports,b=Object.freeze(Object.defineProperty({__proto__:null,default:v},Symbol.toStringTag,{value:"Module"}));export{b as L,l as t};
