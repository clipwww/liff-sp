import{n as m,D as v}from"./index-9ce14ff3.js";import{t as u,a as h}from"./index-681df463.js";const p={beforeRouteLeave(s,t,e){this.$el.querySelectorAll("a").forEach(i=>{i.removeEventListener("mousedown",this.onTouchStart),i.removeEventListener("mouseup",this.onTouchEnd),i.removeEventListener("touchstart",this.onTouchStart),i.removeEventListener("touchend",this.onTouchEnd)}),e()},props:{item:{type:Object,required:!0},isDetails:{ype:Boolean,default:!1},oItem:{type:Object}},data(){return{showPopup:!1,pressTimer:null,isLongPress:!1}},computed:{replyCount(){var e,i;let s=0;const t=this.item.warnText.match(/\d{1,}/g);return t&&(s+=+t[0]),s+=((i=(e=this.item)==null?void 0:e.reply)==null?void 0:i.length)??0,s}},mounted(){this.$el.querySelectorAll("a").forEach(s=>{s.addEventListener("mousedown",this.onTouchStart),s.addEventListener("mouseup",this.onTouchEnd),s.addEventListener("touchstart",this.onTouchStart),s.addEventListener("touchend",this.onTouchEnd)})},methods:{toSafeHtmlString:u,onTouchStart(s){s.preventDefault(),this.pressTimer=window.setTimeout(()=>{var i,o,l,n;this.isLongPress=!0;const t=((o=(i=s.target)==null?void 0:i.getAttribute("href"))==null?void 0:o.replace("#r",""))??"",e=((l=this==null?void 0:this.oItem)==null?void 0:l.id)===t?this.oItem:(n=this==null?void 0:this.oItem)==null?void 0:n.reply.find(a=>a.id===t);e&&v.alert({title:`No. ${e.id}`,message:`<div class="text-center">${e.sImg?`<img src="${e.sImg}" />`:""}</div>${h(e.text)}`.trim(),messageAlign:"left",beforeClose(a,r){clearTimeout(this.pressTimer),this.isLongPress=!1,r()}})},600)},onTouchEnd(s){var n,a,r,c;if(s.preventDefault(),clearTimeout(this.pressTimer),this.isLongPress){this.isLongPress=!1;return}const t=((a=(n=s.target)==null?void 0:n.classList)==null?void 0:a.contains("qlink"))??!1,e=((r=s.target)==null?void 0:r.getAttribute("href"))??"";if(!t){window.liff.openWindow({url:e});return}const i=e.replace("#r",""),o=document.getElementById(`r${i}`),l=o==null?void 0:o.offsetTop;Number.isNaN(l)||(window.scrollTo(0,l-30),(c=o==null?void 0:o.classList)==null||c.add("is-active"),setTimeout(()=>{var d;(d=o==null?void 0:o.classList)==null||d.remove("is-active")},2e3))}}};var _=function(){var t=this,e=t._self._c;return e("div",[e("van-cell",{staticClass:"komica-post-cell",attrs:{id:`r${t.item.id}`,clickable:!t.isDetails},on:{click:function(i){return t.$emit("click")}}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("div",{staticClass:"flex-between is-align-start"},[e("div",{on:{click:function(i){t.isDetails&&(t.showPopup=!0)}}},[t._v(" "+t._s(t.item.title)+" ")]),t.isDetails?t._e():e("div",{staticClass:"margin-l-10"},[e("van-button",{attrs:{plain:"",type:"info",icon:"eye",size:"mini"},on:{click:function(i){return i.stopPropagation(),t.$emit("click-preview")}}},[t._v(" 預覽 ")])],1)]),e("div",{staticClass:"little-text"},[t._v(" No. "+t._s(t.item.id)+" ")])]),t.item.sImg?e("div",{staticClass:"margin-r-10",attrs:{slot:"icon"},slot:"icon"},[e("van-image",{attrs:{src:t.item.sImg,width:"90","lazy-load":""},on:{click:function(i){return t.$emit("click-image",t.item)}}})],1):t._e(),e("div",{attrs:{slot:"label"},slot:"label"},[e("div",{staticClass:"break-word",class:{"van-multi-ellipsis--l3":!t.isDetails,"fs-14":t.isDetails},domProps:{innerHTML:t._s(t.toSafeHtmlString(t.item.text))}}),e("div",{staticClass:"little-text margin-t-15 text-right"},[t._v(" "+t._s(t._f("formatDate")(t.item.dateCreated))+" ")]),t.isDetails?t._e():e("div",{staticClass:"little-text text-right"},[t._v(" 總共 "+t._s(t.replyCount)+" 則回應 ")]),e("div",{attrs:{slot:"right-icon"},slot:"right-icon"},[e("div")])])]),e("van-popup",{style:{height:"50%"},attrs:{round:"",position:"bottom","close-on-popstate":""},model:{value:t.showPopup,callback:function(i){t.showPopup=i},expression:"showPopup"}},[e("div",{staticClass:"padding-t-15 padding-b-20"},[e("van-cell",[e("div",{attrs:{slot:"title"},slot:"title"},[t._v(" No. ")]),e("div",[t._v(t._s(t.item.id))])]),e("van-cell",[e("div",{attrs:{slot:"title"},slot:"title"},[t._v(" 使用者 Id ")]),e("div",[t._v(t._s(t.item.userId))])]),e("van-cell",[e("div",{attrs:{slot:"title"},slot:"title"},[t._v(" 使用者名稱 ")]),e("div",[t._v(t._s(t.item.name))])]),e("van-cell",[e("div",{attrs:{slot:"title"},slot:"title"},[t._v(" 標題 ")]),e("div",[t._v(t._s(t.item.title))])]),e("van-cell",[e("div",{attrs:{slot:"title"},slot:"title"},[t._v(" E-mail ")]),e("div",[t._v(t._s(t.item.email))])]),e("van-cell",[e("div",{attrs:{slot:"title"},slot:"title"},[t._v(" 建立日期 ")]),e("div",[t._v(t._s(t._f("formatDate")(t.item.dateCreated)))])])],1)])],1)},f=[],g=m(p,_,f,!1,null,"abdad2ba",null,null);const w=g.exports;export{w as K};
