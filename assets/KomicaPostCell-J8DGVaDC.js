import{t as p,a as E}from"./index-CxtZNmhB.js";import{_ as L,J as _,r as c,o as v,c as f,a as o,w as n,g as s,C as k,t as r,f as h,K as y,b}from"./index-COOF5Zia.js";const C={beforeRouteLeave(i,t,e){this.$el.querySelectorAll("a").forEach(l=>{l.removeEventListener("mousedown",this.onTouchStart),l.removeEventListener("mouseup",this.onTouchEnd),l.removeEventListener("touchstart",this.onTouchStart),l.removeEventListener("touchend",this.onTouchEnd)}),e()},props:{item:{type:Object,required:!0},isDetails:{ype:Boolean,default:!1},oItem:{type:Object}},data(){return{showPopup:!1,pressTimer:null,isLongPress:!1}},computed:{replyCount(){let i=0;const t=this.item.warnText.match(/\d{1,}/g);return t&&(i+=+t[0]),i+=this.item?.reply?.length??0,i}},mounted(){this.$el.querySelectorAll("a").forEach(i=>{i.addEventListener("mousedown",this.onTouchStart),i.addEventListener("mouseup",this.onTouchEnd),i.addEventListener("touchstart",this.onTouchStart),i.addEventListener("touchend",this.onTouchEnd)})},methods:{toSafeHtmlString:p,onTouchStart(i){i.preventDefault(),this.pressTimer=window.setTimeout(()=>{this.isLongPress=!0;const t=i.target?.getAttribute("href")?.replace("#r","")??"",e=this?.oItem?.id===t?this.oItem:this?.oItem?.reply.find(l=>l.id===t);e&&_.alert({title:`No. ${e.id}`,message:`<div class="text-center">${e.sImg?`<img src="${e.sImg}" />`:""}</div>${E(e.text)}`.trim(),messageAlign:"left",beforeClose(l,a){clearTimeout(this.pressTimer),this.isLongPress=!1,a()}})},600)},onTouchEnd(i){if(i.preventDefault(),clearTimeout(this.pressTimer),this.isLongPress){this.isLongPress=!1;return}const t=i.target?.classList?.contains("qlink")??!1,e=i.target?.getAttribute("href")??"";if(!t){window.liff.openWindow({url:e});return}const l=e.replace("#r",""),a=document.getElementById(`r${l}`),u=a?.offsetTop;Number.isNaN(u)||(window.scrollTo(0,u-30),a?.classList?.add("is-active"),setTimeout(()=>{a?.classList?.remove("is-active")},2e3))}}},D={class:"flex-between is-align-start"},S={key:0,class:"margin-l-10"},I={class:"little-text"},P={key:0,class:"margin-r-10"},x=["innerHTML"],N={class:"little-text margin-t-15 text-right"},A={key:0,class:"little-text text-right"},B={class:"padding-t-15 padding-b-20"};function H(i,t,e,l,a,u){const g=c("van-button"),T=c("van-image"),d=c("van-cell"),w=c("van-popup");return v(),f("div",null,[o(d,{id:`r${e.item.id}`,class:"komica-post-cell",clickable:!e.isDetails,onClick:t[3]||(t[3]=m=>i.$emit("click"))},{title:n(()=>[s("div",D,[s("div",{onClick:t[0]||(t[0]=m=>e.isDetails?a.showPopup=!0:"")},r(e.item.title),1),e.isDetails?h("",!0):(v(),f("div",S,[o(g,{plain:"",type:"info",icon:"eye",size:"mini",onClick:t[1]||(t[1]=y(m=>i.$emit("click-preview"),["stop"]))},{default:n(()=>[...t[5]||(t[5]=[b(" 預覽 ",-1)])]),_:1})]))]),s("div",I," No. "+r(e.item.id),1)]),icon:n(()=>[e.item.sImg?(v(),f("div",P,[o(T,{src:e.item.sImg,width:"90","lazy-load":"",onClick:t[2]||(t[2]=m=>i.$emit("click-image",e.item))},null,8,["src"])])):h("",!0)]),label:n(()=>[s("div",{class:k(["break-word",{"van-multi-ellipsis--l3":!e.isDetails,"fs-14":e.isDetails}]),innerHTML:u.toSafeHtmlString(e.item.text)},null,10,x),s("div",N,r(i.$filters.formatDate(e.item.dateCreated)),1),e.isDetails?h("",!0):(v(),f("div",A," 總共 "+r(u.replyCount)+" 則回應 ",1))]),_:1},8,["id","clickable"]),o(w,{show:a.showPopup,"onUpdate:show":t[4]||(t[4]=m=>a.showPopup=m),round:"",position:"bottom","close-on-popstate":"",style:{height:"50%"}},{default:n(()=>[s("div",B,[o(d,null,{title:n(()=>[...t[6]||(t[6]=[s("div",null,"No.",-1)])]),default:n(()=>[s("div",null,r(e.item.id),1)]),_:1}),o(d,null,{title:n(()=>[...t[7]||(t[7]=[s("div",null,"使用者 Id",-1)])]),default:n(()=>[s("div",null,r(e.item.userId),1)]),_:1}),o(d,null,{title:n(()=>[...t[8]||(t[8]=[s("div",null,"使用者名稱",-1)])]),default:n(()=>[s("div",null,r(e.item.name),1)]),_:1}),o(d,null,{title:n(()=>[...t[9]||(t[9]=[s("div",null,"標題",-1)])]),default:n(()=>[s("div",null,r(e.item.title),1)]),_:1}),o(d,null,{title:n(()=>[...t[10]||(t[10]=[s("div",null,"E-mail",-1)])]),default:n(()=>[s("div",null,r(e.item.email),1)]),_:1}),o(d,null,{title:n(()=>[...t[11]||(t[11]=[s("div",null,"建立日期",-1)])]),default:n(()=>[s("div",null,r(i.$filters.formatDate(e.item.dateCreated)),1)]),_:1})])]),_:1},8,["show"])])}const z=L(C,[["render",H],["__scopeId","data-v-41638c66"]]);export{z as K};
